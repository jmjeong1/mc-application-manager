import{M as q,_ as M}from"./bootstrap.esm-Cpkrkyti.js";import{_ as G}from"./Tabulator.vue_vue_type_style_index_0_lang-CIPLrzS_.js";import{s as f}from"./request-DJv9NrOs.js";import{d as I,r as d,u as T,c as W,w as N,o as L,a as p,b as e,t as U,e as O,v as j,F as z,f as H,g as x,h as b,i as _}from"./index-BHPkE3P8.js";import"./IconPlus-CVN_oQZM.js";const J=()=>f.get("/ossType/list"),K=()=>f.get("/ossType/filter/list"),Q=()=>f.get("/oss/list");function X(l){return f.get(`/oss/duplicate?ossName=${l.ossName}&ossUrl=${l.ossUrl}&ossUsername=${l.ossUsername}`)}function Y(l){return f.post("/oss/connection-check",l)}function Z(l){return f.get("/oss/"+l)}function ss(l){return f.post("/oss",l)}function es(l){return f.patch(`/oss/${l.ossIdx}`,l)}function ts(l){return f.delete(`/oss/${l}`)}const os={class:"modal-dialog modal-xl",role:"document"},as={class:"modal-content"},ls={class:"modal-body text-left py-4"},ns={class:"mb-5"},rs={class:"mb-3"},is={class:"grid gap-0 column-gap-3"},ds=["value"],cs={class:"row mb-3"},us={class:"grid gap-0 column-gap-3"},ms={class:"mb-3"},vs={class:"mb-3"},ps={class:"row"},bs={class:"col"},fs={class:"col"},ys={class:"col mt-4 row"},gs={key:1,class:"btn btn-success col",style:{"margin-right":"3px"}},ws={key:3,class:"btn btn-success col"},Ss={class:"modal-footer"},Os=I({__name:"ossForm",props:{mode:{},ossIdx:{}},emits:["get-oss-list"],setup(l,{emit:k}){const m=d(),c=d(),o=T(),r=l,g=k,i=W(()=>r.ossIdx);N(i,async()=>{await y()}),N(()=>r.mode,async()=>{await v(r.mode)}),L(async()=>{m.value&&(c.value=new q(m.value)),await v("init"),await y()});const t=d({}),y=async()=>{if(r.mode==="new")t.value.ossTypeIdx=0,t.value.ossName="",t.value.ossDesc="",t.value.ossUrl="",t.value.ossUsername="",t.value.ossPassword="",u.value=!1,S.value=!1;else{const{data:a}=await Z(r.ossIdx);t.value=a,t.value.ossPassword=B(t.value.ossPassword),u.value=!0,S.value=!0}},C=d([]),v=async a=>{try{if(a==="new"||a==="init"){const{data:s}=await K();C.value=s}else{const{data:s}=await J();C.value=s}}catch(s){console.log(s)}},w=()=>{t.value.ossPassword="",S.value=!1},u=d(!1),h=async()=>{const a={ossName:t.value.ossName,ossUrl:t.value.ossUrl,ossUsername:t.value.ossUsername},{data:s}=await X(a);s?o.error("The name is already in use."):(o.success("The name is available."),u.value=!0)},S=d(!1),$=async()=>{const a={ossUrl:t.value.ossUrl,ossUsername:t.value.ossUsername,ossPassword:P(t.value.ossPassword),ossTypeIdx:t.value.ossTypeIdx},{data:s}=await Y(a);s?(o.success("The OSS is available."),S.value=!0):o.error("The OSS is unavailable.")},F=()=>{u.value=!1},D=()=>{S.value=!1},E=async()=>{if(!t.value.ossTypeIdx||t.value.ossTypeIdx===0){o.error("Please select OSS Type.");return}if(!t.value.ossName){o.error("Please enter OSS Name.");return}if(!t.value.ossDesc){o.error("Please enter OSS Description.");return}if(!t.value.ossUrl){o.error("Please enter URL.");return}if(!t.value.ossUsername){o.error("Please enter OSS ID.");return}if(!t.value.ossPassword){o.error("Please enter OSS Password.");return}if(!u.value){o.error("Please perform duplicate check.");return}if(!S.value){o.error("Please perform connection check.");return}t.value.ossPassword=P(t.value.ossPassword);let a=!1;r.mode==="new"?a=await R():a=await A(),a&&(g("get-oss-list"),y(),console.log(c.value),c.value&&(c.value.hide(),setTimeout(()=>{document.body.classList.remove("modal-open");const s=document.querySelector(".modal-backdrop");s==null||s.remove()},150)))},R=async()=>{try{const{data:a}=await ss(t.value);return a?(o.success("Regist SUCCESS."),!0):(o.error("Regist FAIL."),!1)}catch{return o.error("Regist FAIL."),!1}},A=async()=>{try{const{data:a}=await es(t.value);return a?(o.success("Update SUCCESS."),!0):(o.error("Update FAIL."),!1)}catch{return o.error("Update FAIL."),!1}},P=a=>btoa(a),B=a=>atob(a);return(a,s)=>(b(),p("div",{class:"modal fade",id:"ossForm",tabindex:"-1",ref_key:"modalElement",ref:m},[e("div",os,[e("div",as,[s[15]||(s[15]=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1)),e("div",ls,[e("h3",ns,U(r.mode==="new"?"New":"Edit")+" OSS ",1),e("div",null,[e("div",rs,[s[9]||(s[9]=e("label",{class:"form-label required"},"OSS Type",-1)),e("div",is,[O(e("select",{"onUpdate:modelValue":s[0]||(s[0]=n=>t.value.ossTypeIdx=n),class:"form-select p-2 g-col-12"},[s[8]||(s[8]=e("option",{value:0},"Select OSS Type",-1)),(b(!0),p(z,null,H(C.value,(n,V)=>(b(),p("option",{value:n.ossTypeIdx,key:V},U(n.ossTypeName),9,ds))),128))],512),[[j,t.value.ossTypeIdx]])])]),e("div",cs,[s[10]||(s[10]=e("label",{class:"form-label required"},"OSS Name",-1)),e("div",us,[O(e("input",{type:"text",class:"form-control p-2 g-col-11",placeholder:"Enter the OSS Name","onUpdate:modelValue":s[1]||(s[1]=n=>t.value.ossName=n),onChange:F},null,544),[[x,t.value.ossName]])])]),e("div",ms,[s[11]||(s[11]=e("label",{class:"form-label required"},"OSS Description",-1)),O(e("input",{type:"text",class:"form-control p-2 g-col-11",placeholder:"Enter the OSS Description","onUpdate:modelValue":s[2]||(s[2]=n=>t.value.ossDesc=n)},null,512),[[x,t.value.ossDesc]])]),e("div",vs,[s[12]||(s[12]=e("label",{class:"form-label required"},"URL",-1)),O(e("input",{type:"text",class:"form-control p-2 g-col-7",placeholder:"Enter the Server URL","onUpdate:modelValue":s[3]||(s[3]=n=>t.value.ossUrl=n),onFocus:D},null,544),[[x,t.value.ossUrl]])]),e("div",ps,[e("div",bs,[s[13]||(s[13]=e("label",{class:"form-label required"},"OSS ID",-1)),O(e("input",{type:"text",class:"form-control p-2 g-col-7",placeholder:"Enter the OSS ID","onUpdate:modelValue":s[4]||(s[4]=n=>t.value.ossUsername=n),onFocus:D},null,544),[[x,t.value.ossUsername]])]),e("div",fs,[s[14]||(s[14]=e("label",{class:"form-label required"},"OSS PW",-1)),O(e("input",{type:"password",class:"form-control p-2 g-col-11",placeholder:"Enter the OSS Password","onUpdate:modelValue":s[5]||(s[5]=n=>t.value.ossPassword=n),onClick:w,onFocus:D},null,544),[[x,t.value.ossPassword]])]),e("div",ys,[u.value?(b(),p("button",gs,"Duplicate Check")):(b(),p("button",{key:0,class:"btn btn-primary col",onClick:h,style:{"margin-right":"3px"}},"Duplicate Check")),S.value?(b(),p("button",ws,"Connection Check")):(b(),p("button",{key:2,class:"btn btn-primary col",onClick:$},"Connection Check"))])])])]),e("div",Ss,[e("button",{type:"button",class:"btn btn-link link-secondary","data-bs-dismiss":"modal",onClick:s[6]||(s[6]=n=>y())}," Cancel "),e("button",{type:"button",ref:"submitBtn",class:"btn btn-primary ms-auto",onClick:s[7]||(s[7]=n=>E())},U(r.mode==="new"?"Regist":"Edit"),513)])])])],512))}}),ks={class:"modal fade",id:"deleteOss",tabindex:"-1"},Cs={class:"modal-dialog modal-lg",role:"document"},xs={class:"modal-content"},_s={class:"modal-body text-left py-4"},Us={class:"modal-footer"},hs=I({__name:"deleteOss",props:{ossName:{},ossIdx:{}},emits:["get-oss-list"],setup(l,{emit:k}){const m=T(),c=l,o=k,r=async()=>{const{data:g}=await ts(c.ossIdx);g?m.success("Deleted successfully."):m.error("Failed to delete."),o("get-oss-list")};return(g,i)=>(b(),p("div",ks,[e("div",Cs,[e("div",xs,[i[3]||(i[3]=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1)),i[4]||(i[4]=e("div",{class:"modal-status bg-danger"},null,-1)),e("div",_s,[i[1]||(i[1]=e("h3",{class:"mb-5"}," Delete OSS ",-1)),e("h4",null,"Are you sure you want to delete "+U(c.ossName)+"?",1)]),e("div",Us,[i[2]||(i[2]=e("a",{href:"#",class:"btn btn-link link-secondary","data-bs-dismiss":"modal"}," Cancel ",-1)),e("a",{href:"#",class:"btn btn-primary ms-auto","data-bs-dismiss":"modal",onClick:i[0]||(i[0]=t=>r())}," Delete ")])])])]))}}),Ds={class:"card card-flush w-100"},Is={ref:"table-responsive"},Fs=I({__name:"OssList",setup(l){const k=T(),m=d([]),c=d([]);L(async()=>{i(),await o()});const o=async()=>{try{const{data:v}=await Q();m.value=v}catch(v){console.log(v),k.error("데이터를 가져올 수 없습니다.")}},r=d(0),g=d(""),i=()=>{c.value=[{title:"OSS Name",field:"ossName",width:400},{title:"OSS Desc",field:"ossDesc",width:500},{title:"URL",field:"ossUrl",width:600},{title:"Action",width:400,formatter:t,cellClick:function(v,w){const u=v.target,h=u==null?void 0:u.getAttribute("id");r.value=w.getRow().getData().ossIdx,h==="edit-btn"?y.value="edit":g.value=w.getRow().getData().ossName}}]},t=()=>`
  <div>
    <button
      class='btn btn-primary d-none d-sm-inline-block me-1'
      id='edit-btn'
      data-bs-toggle='modal'
      data-bs-target='#ossForm'>
      EDIT
    </button>
    <button
      class='btn btn-danger d-none d-sm-inline-block'
      id='delete-btn'
      data-bs-toggle='modal'
      data-bs-target='#deleteOss'>
      DELETE
    </button>
  </div>`,y=d("new"),C=()=>{r.value=0,y.value="new"};return(v,w)=>(b(),p("div",Ds,[_(M,{"header-title":"OSS","new-btn-title":"New OSS","popup-flag":!0,"popup-target":"#ossForm",onClickNewBtn:C}),_(G,{columns:c.value,"table-data":m.value},null,8,["columns","table-data"]),e("div",Is,w[0]||(w[0]=[e("div",{class:"table table-vcenter table-bordered table-nowrap card-table"},null,-1)]),512),_(Os,{mode:y.value,"oss-idx":r.value,onGetOssList:o},null,8,["mode","oss-idx"]),_(hs,{"oss-name":g.value,"oss-idx":r.value,onGetOssList:o},null,8,["oss-name","oss-idx"])]))}});export{Fs as default};
